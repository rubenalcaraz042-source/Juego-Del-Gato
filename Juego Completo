#include <iostream>
#include <cstdlib>
using namespace std;

// Prototipos de funciones
void mostrarTablero(char tablero[3][3]);
bool hacerMovimiento(char tablero[3][3], int fila, int columna, char jugador);
bool verificarGanador(char tablero[3][3], char jugador);
bool tableroLleno(char tablero[3][3]);
void reiniciarTablero(char tablero[3][3]);
void menu();

// Funci√≥n principal
int main() {
    menu();
    return 0;
}

// Muestra el men√∫ principal
void menu() {
    char opcion;
    char tablero[3][3];
    bool jugando = true;

    do {
        cout << "===== JUEGO DEL GATO (TIC TAC TOE) =====\n";
        cout << "1. Jugar\n";
        cout << "2. Salir\n";
        cout << "Seleccione una opci√≥n: ";
        cin >> opcion;

        if (opcion == '1') {
            reiniciarTablero(tablero);
            char jugador = 'X';
            bool finJuego = false;

            while (!finJuego) {
                system("cls"); // Limpia pantalla (en Windows)
                mostrarTablero(tablero);
                int fila, columna;

                cout << "\nTurno del jugador " << jugador << endl;
                cout << "Ingrese fila (1-3): ";
                cin >> fila;
                cout << "Ingrese columna (1-3): ";
                cin >> columna;

                if (!cin || fila < 1 || fila > 3 || columna < 1 || columna > 3) {
                    cout << "Entrada inv√°lida. Intente nuevamente.\n";
                    cin.clear();
                    cin.ignore(10000, '\n');
                    system("pause");
                    continue;
                }

                if (!hacerMovimiento(tablero, fila - 1, columna - 1, jugador)) {
                    cout << "Esa casilla ya est√° ocupada. Intente de nuevo.\n";
                    system("pause");
                    continue;
                }

                // Verificar si alguien gan√≥
                if (verificarGanador(tablero, jugador)) {
                    system("cls");
                    mostrarTablero(tablero);
                    cout << "\nüéâ ¬°Jugador " << jugador << " ha ganado! üéâ\n";
                    finJuego = true;
                } else if (tableroLleno(tablero)) {
                    system("cls");
                    mostrarTablero(tablero);
                    cout << "\nüòê ¬°Empate! üòê\n";
                    finJuego = true;
                }

                // Cambiar jugador
                jugador = (jugador == 'X') ? 'O' : 'X';
            }

            cout << "\n¬øDesea jugar otra vez? (s/n): ";
            cin >> opcion;
            if (opcion == 's' || opcion == 'S')
                continue;
            else
                jugando = false;

        } else if (opcion == '2') {
            cout << "Saliendo del juego...\n";
            jugando = false;
        } else {
            cout << "Opci√≥n inv√°lida.\n";
        }

    } while (jugando);
}

// Inicializa el tablero vac√≠o
void reiniciarTablero(char tablero[3][3]) {
    char pos = '1';
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 3; j++) {
            tablero[i][j] = pos++;
        }
    }
}

// Muestra el tablero en pantalla
void mostrarTablero(char tablero[3][3]) {
    cout << "\n";
    for (int i = 0; i < 3; i++) {
        cout << " ";
        for (int j = 0; j < 3; j++) {
            cout << tablero[i][j];
            if (j < 2) cout << " | ";
        }
        cout << "\n";
        if (i < 2) cout << "---|---|---\n";
    }
}

// Realiza un movimiento en el tablero
bool hacerMovimiento(char tablero[3][3], int fila, int columna, char jugador) {
    if (tablero[fila][columna] != 'X' && tablero[fila][columna] != 'O') {
        tablero[fila][columna] = jugador;
        return true;
    }
    return false;
}

// Verifica si el jugador gan√≥
bool verificarGanador(char tablero[3][3], char jugador) {
    for (int i = 0; i < 3; i++) {
        if (tablero[i][0] == jugador && tablero[i][1] == jugador && tablero[i][2] == jugador) return true;
        if (tablero[0][i] == jugador && tablero[1][i] == jugador && tablero[2][i] == jugador) return true;
    }
    if (tablero[0][0] == jugador && tablero[1][1] == jugador && tablero[2][2] == jugador) return true;
    if (tablero[0][2] == jugador && tablero[1][1] == jugador && tablero[2][0] == jugador) return true;

    return false;
}

// Comprueba si el tablero est√° lleno (empate)
bool tableroLleno(char tablero[3][3]) {
    for (int i = 0; i < 3; i++)
        for (int j = 0; j < 3; j++)
            if (tablero[i][j] != 'X' && tablero[i][j] != 'O')
                return false;
    return true;
}
